[#using-rh-insights]
= Using observability with Red Hat Insights

Red Hat Insights is integrated with {product-title-short} observability, and is enabled to help identify existing or potential problems in your clusters. Red Hat Insights helps you to identify, prioritize, and resolve stability, performance, network, and security risks. {ocp} offers cluster health monitoring through Red Hat OpenShift Cluster Manager. Red Hat OpenShift Cluster Manager collects anonymized, aggregated information about the health, usage, and size of the clusters. For more information, see link:https://access.redhat.com/documentation/en-us/red_hat_insights/2021/[Red Hat Insights product documentation].

When you create or import an OpenShift cluster, anonymized data from your managed cluster is automatically sent to Red Hat. This information is used to create insights, which provide cluster health information. {product-title-short} administrator can use this health information to create alerts based on severity.

*Required access*: Cluster administrator

[#prerequisites-obs-insights]
== Prerequisites

* Ensure that Red Hat Insights is enabled. For more information, see link:https://docs.openshift.com/container-platform/4.13/support/remote_health_monitoring/opting-out-of-remote-health-reporting.html#insights-operator-new-pull-secret_opting-out-remote-health-reporting[Modifying the global cluster pull secret to disable remote health reporting].
* Install {ocp-short} version 4.0 or later.
* Hub cluster user, who is registered to Red Hat OpenShift Cluster Manager, must be able to manage all the {product-title-short} managed clusters in Red Hat OpenShift Cluster Manager.

[#managing-insights]
== Managing insight _PolicyReports_

{product-title} `PolicyReports` are violations that are generated by the `insights-client`. The `PolicyReports` are used to define and configure alerts that are sent to incident management systems. When there is a violation, alerts from a `PolicyReport` are sent to incident management system.

[#search-insight-policy-report-violation]
=== Searching for insight policy reports

You can search for a specific insight `PolicyReport` that has a violation, across your managed clusters. Complete the following steps:

. Log in to your {product-title-short} hub cluster.
. Select *Search* from the navigation menu.
. Enter the following query: `kind:PolicyReport`.
+
*Note:* The `PolicyReport` name matches the name of the cluster. 

. You can specify your query with the insight policy violation and categories. When you select a `PolicyReport` name, you are redirected to the _Details_ page of the associated cluster. The _Insights_ sidebar is automatically displayed.

. If the search service is disabled and you want to search for an insight, run the following command from your hub cluster:
+
----
oc get policyreport --all-namespaces
----

[#viewing-vulnerabilities-insights]
=== Viewing identified issues from the console

You can view the identified issues on a specific cluster. Complete the following steps:

. Log in to your {product-title-short} cluster.
. Select *Overview* from the navigation menu. 
. Check the _Cluster issues_ summary card. Select a severity link to view the `PolicyReports` that are associated with that severity. Details of the cluster issues and the severities are displayed from the _Search_ page. Policy reports that are associated with the severity and have one or more issues appear.
. Select a policy report to view cluster details from the _Clusters_ page. The _Status_ card displays information about _Nodes_, _Applications_, _Policy violations_, and _Identified issues_.
. Select the *Number of identified issues* to view details. The _Identified issues_ card represents the information from Red Hat insights. The _Identified issues_ status displays the number of issues by severity. The triage levels used for the issues are the following severity categories: _Critical_, _Major_, _Low_, and _Warning_.
.. Alternatively, you can select *Clusters* from the navigation menu.
.. Select a managed cluster from the table to view more details. 
.. From the _Status_ card, view the number of identified issues.
. Select the number of potential issues to view the severity chart and recommended remediations for the issues from the _Potential issue_ side panel. You can also use the search feature to search for recommended remediations. The remediation option displays the _Description_ of the vulnerability, _Category_ that vulnerability is associated with, and the _Total risk_.
. Click the link to the vulnerability to view steps on _How to remediate_ and the _Reason_ for the vulnerability.
+
*Note:* When you resolve the issue, you receive the Red Hat Insights every 30 minutes, and Red Hat Insights is updated every two hours.

. Be sure to verify which component sent the alert message from the `PolicyReport`. 
.. Navigate to the _Governance_ page and select a specific `PolicyReport`.
.. Select the _Status_ tab and click the *View details* link to view the `PolicyReport` YAML file.
.. Locate the `source` parameter, which informs you of the component that sent the violation. The value options are `grc` and `insights`.

[#update-risks]
=== Viewing update risk predictions

View the potential risks of updating your managed clusters. Complete the following steps:

. Log in to your managed cluster. 
. Go to the _Overview_ page. 
. From the _Powered by Insights_ section, you can view the percentage of clusters with predicted risks, which are listed by severity.
. Select the number for the severity to view the list of clusters from the _Clusters_ page.
. Select the cluster that you want, then click the *Actions* drop-down button.
. Click *Upgrade clusters* to view the risk for the upgdate.
. Click the link in the _Upgrade risks_ column from the _Upgrade clusters_ modal. Information is displayed from the Hybrid Cloud console.

[#additional-resources-insight]
== Additional resources

- Learn how to create custom alert rules for the `PolicyReports`, see xref:../observability/customize_observability.adoc#configuring-alertmanager[Configuring Alertmanager] for more information.

- See xref:../observe_environments_intro.adoc#observing-environments-intro[Observability service].
