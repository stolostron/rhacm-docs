[#config-policy-generator]
= Configuring the policy generator
//is the policy generator automatically installed or enabled by default? 
Configure the policy generator with GitOps to create policies from Kustomize manifests. 

*Required access*: Cluster administrator

Complete the following steps to configure the policy generator:

. Install the Kustomize plugin.
+
.. Download the plugin binary from the link:https://github.com/open-cluster-management/policy-generator-plugin/releases[release] that you choose to use.
+
.. Create the plugin directory with the following command:
+
----
mkdir -p ${HOME}/.config/kustomize/plugin/policy.open-cluster-management.io/v1/policygenerator
----
+
.. Move the binary to the plugin directory: 
+
** For Linux, run the following command:
+
----
chmod +x linux-amd64-PolicyGenerator
mv linux-amd64-PolicyGenerator ${HOME}/.config/kustomize/plugin/policy.open-cluster-management.io/v1/policygenerator/PolicyGenerator
----
+
** For MacOS, run the following command:
+
----
chmod +x darwin-amd64-PolicyGenerator
mv darwin-amd64-PolicyGenerator ${HOME}/.config/kustomize/plugin/policy.open-cluster-management.io/v1/policygenerator/PolicyGenerator
----
+
.. Build the plugin binary, which is only needed once or to update the plugin. Run the following command:
+
----
make build
----
+
*Note*: By default, the binary in the `${HOME}/.config/kustomize/plugin` directory. You can change this by exporting `KUSTOMIZE_PLUGIN_HOME` to a different path.

. Create a `kustomization.yml` file that references the `PolicyGenerator` manifests with any additional desired patches or customizations. See link:https://github.com/open-cluster-management/policy-generator-plugin/blob/main/examples/policyGenerator.yaml[`examples/policyGenerator.yaml`] for an example. Your `kustomization.yml` might resemble the following file:
+
[source,yaml]
----
generators:
- ./policyGenerator.yaml
patchesStrategicMerge:
- input/patch.yaml
commonLabels:
  custom: myApp
----

. Complete one of the following tasks to use the plugin to generate policies:
+
** Utilize the `examples/` directory in the `policy-generator-plugin` repository; the directory can be modified by exporting a new path to `SOURCE_DIR`. Run the following command:
+
----
make generate
----
+
** Run the following command from any directory with a `kustomization.yaml` file pointing to the `PolicyGenerator` manifests:
+
----
kustomize build --enable-alpha-plugins
----

[#verifying-policy-generator]
== Verifying the policy generator

Verify that the policy generator is deployed successfully. Complete the following steps:

. Log in to the {product-title-short} console.
. From the navigation menu, select *Governance*. 
. Select a policy from the table list to view more details.
. Select the _Clusters_ tab to view the compliance status and configuration policies that are associated with the selected policy.
. From the console header, select the *Applications* icon > *{ocp-short}*.
. From the {ocp-short} navigation menu, select *Routes*. Then select the link found in the _Location_ column to verify that the policy generator is deployed successfully. 

