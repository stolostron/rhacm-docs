[#managing-gatekeeper-operator-installation-policies]
= Managing the {gate} installation policies

Use the {acm-short} policy to install the {gate} and Gatekeeper on a managed cluster. 

*Required access*: Cluster administrator

To create, view, and update your {gate} installation policies, complete the following sections: 

- <<installing-gatekeeper-operator-policy,Installing Gatekeeper using a {gate} policy>>
- <<creating-a-gatekeeper-policy-from-the-console,Creating a Gatekeeper policy from the console>>
- <<upgrading-gatekeeper-gatekeeper-operator,Upgrading Gatekeeper and the {gate}>>
- <<disabling-gatekeeper-operator-policy,Disabling {gate} policy>>
- <<deleting-gatekeeper-operator-policy,Deleting {gate} policy>>
- <<uninstalling-gatekeeper,Uninstalling Gatekeeper policy, Gatekeeper, and {gate} policy>>

[#installing-gatekeeper-operator-policy]
== Installing Gatekeeper using a {gate} policy

To install the {gate} policy, use the configuration policy controller. During the install, the operator group and subscription pull the {gate} to install it in your managed cluster. Then, the {gate} creates a Gatekeeper custom resource to configure Gatekeeper. 

To view the status of the {gate} policy, see the {acm-short} configuration policy controller because it checks the {gate} policy and supports the  `enforce` remediation action. When you set the controller to `enforce` it automatically creates the {gate} objects on the managed cluster. 

[#creating-a-gatekeeper-policy-from-the-console]
== Creating a Gatekeeper policy from the console

When you create a Gatekeeper policy from the console, you must set your remediation `enforce` to install Gatekeeper. By default, the operator generates the values. 

[#viewing-gatekeeper-operator-policy]
=== Viewing the {gate} policy

To view your {gate} policy and its status from the console, complete the following steps:

. Select the `policy-gatekeeper-operator` policy to view more details.
. Select the _Clusters_ tab to view the policy violations. 

[#upgrading-gatekeeper-gatekeeper-operator]
== Upgrading Gatekeeper and the {gate}

You can upgrade the versions for Gatekeeper and the {gate}. When you install the {gate} with the {gate} policy, notice the value for `upgradeApproval`. The operator upgrades automatically when you set `upgradeApproval` to `Automatic`.

If you set `upgradeApproval` to `Manual`, you must manually approve the upgrade for each cluster of the {gate}.

[#disabling-gatekeeper-operator-policy]
== Disabling {gate} policy

To disable your `policy-gatekeeper-operator` policy, select the *Disable* option from the _Actions_ menu.
. Click *Disable*. The _Disable Policy_ dialog box appears.
. Click *Disable policy*. 

[#deleting-gatekeeper-operator-policy]
== Deleting {gate} policy

To delete your {gate} policy from your CLI, complete the following steps: 

. Delete {gate} policy by running the following command:

+
[source,bash]
----
oc delete policies.policy.open-cluster-management.io <policy-gatekeeper-operator-name> -n <namespace>
----

 . Verify that you deleted your policy by running the following command:

+
[source,bash]
----
oc get policies.policy.open-cluster-management.io <policy-gatekeeper-operator-name> -n <namespace>
----

To delete your {gate} policy from the console, click the *Actions* icon for the `policy-gatekeeper-operator` policy and select *Remove*.

[#uninstalling-gatekeeper]
== Uninstalling Gatekeeper policy, Gatekeeper, and {gate} policy

To uninstall Gatekeeper policy, complete the steps in the following sections:

- <<removing-gatekeeper-constraint,Removing Gatekeeper _Constraint_>>
- <<removing-gatekeeper-instance,Removing Gatekeeper instance>>
- <<removing-gatekeeper-operator,Removing {gate}>>

[#removing-gatekeeper-constraint]
=== Removing Gatekeeper _Constraint_

To remove the Gatekeeper constraint and `ConstraintTemplate` from your managed cluster, complete the following steps:

. Edit your Gatekeeper constraint or `ConstraintTemplate` policy. 
. Locate the template that you used to create the Gatekeeper `Constraint` and `ConstraintTemplate`.
. Delete the entries from the list of templates. (Or delete the policy if they're the only templates.)
. Save and apply the policy.

[#removing-gatekeeper-instance]
=== Removing Gatekeeper instance 

To remove the Gatekeeper instance from your managed cluster, complete the following steps:

. Edit your {gate} policy. 
. Locate the `ConfigurationPolicy` template that you used to create the Gatekeeper custom resource.
. Change the value for `complianceType` of the `ConfigurationPolicy` template to `mustnothave`.

[#removing-gatekeeper-operator]
=== Removing {gate}

To remove the {gate} from your managed cluster, complete the following steps: 

. Edit your {gate} policy. 
. Locate the `OperatorPolicy` template that you used to create the Subscription CR.
. Change the value for `complianceType` of the `OperatorPolicy` template to `mustnothave`.

[#additional-resources-gk-operator]
== Additional resources

For more details, see the following resources: 

- xref:../gatekeeper_operator/gatekeeper_policy_constraints.adoc#integrating-gatekeeper-constraints-templates[Integrating Gatekeeper constraints and constraint templates].

- link:https://github.com/open-cluster-management-io/policy-collection/blob/main/stable/CM-Configuration-Management/policy-gatekeeper-operator-downstream.yaml[Policy Gatekeeper].

- For an explanation of the optional parameters that can be used for the {gate} policy, see link:https://github.com/open-policy-agent/gatekeeper/blob/master/charts/gatekeeper/README.md[Gatekeeper Helm Chart].

- For a list of topics to integrate third-party policies with the product, see xref:../governance/third_party_policy_intro.adoc#integrate-third-party-policy-controllers[Integrate third-party policy controllers]. 

