[#managing-certificates]
= Managing certificates

* <<observability-byo-certificates,Bring Your Own (BYO) observability certificate authority (CA) certificates>>
* <<openssl-commands-ca,Generating CA certificates by using OpenSSL commands>>
* <<create-secrets-byo-certs,Creating the secrets associated with the BYO observability CA certificates>>
* <<replacing-certs,Replacing certificates>>


[#observability-byo-certificates]
== Bring Your Own (BYO) observability certificate authority (CA) certificates

If you do not want to use the default observability CA certificates generated by {product-title-short}, you can choose to use the BYO observability CA certificates before you enable observability.

//how does the user complete the above task? 
[#openssl-commands-ca]
== Generating CA certificates by using OpenSSL commands

Observability requires two CA certificates; one is for the server-side and the other is for the client-side.

* Generate your CA RSA private keys with the following commands:
+
----
openssl genrsa -out serverCAKey.pem 2048

openssl genrsa -out clientCAKey.pem 2048
----

* Generate the self-signed CA certificates using the private keys. Run the following commands:
+
----
openssl req -x509 -sha256 -new -nodes -key serverCAKey.pem -days 1825 -out serverCACert.pem

openssl req -x509 -sha256 -new -nodes -key clientCAKey.pem -days 1825 -out clientCACert.pem
----

[#create-secrets-byo-certs]
== Creating the secrets associated with the BYO observability CA certificates

Complete the following steps to create the secrets:

. Create the `observability-server-ca-certs` secret by using your certificate and private key. Run the following command:
+
----
oc -n open-cluster-management-observability create secret tls observability-server-ca-certs --cert ./serverCACert.pem --key ./serverCAKey.pem
----

. Create the `observability-client-ca-certs` secret by using your certificate and private key. Run the following command:
+
----
oc -n open-cluster-management-observability create secret tls observability-client-ca-certs --cert ./clientCACert.pem --key ./clientCAKey.pem
----

[#replacing-certs]
== Replacing certificates


[#replacing-cert-alertmanager]
=== Replacing certificates for alertmanager route

You can replace alertmanager certificates by updating the alertmanager route, if you do not want to use the OpenShift default ingress certificate. Complete the following steps:

. Examine the observability certificate with the following command:
+
----
openssl x509  -noout -text -in ./observability.crt
----

. Change the common name (`CN`) on the certificate to `alertmanager`.

. Change the SAN in the `csr.cnf` configuration file with the hostname for your alertmanager route.

. Create the two following secrets in the `open-cluster-management-observability` namespace. Run the following command:
+
----
oc -n open-cluster-management-observability create secret tls alertmanager-byo-ca --cert ./ca.crt --key ./ca.key

oc -n open-cluster-management-observability create secret tls alertmanager-byo-cert --cert ./ingress.crt --key ./ingress.key
----